<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herp Derp</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@7.0.0-beta.3/babel.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <section id="app">
    </section>
    <script type="text/babel">
        // tmg creates 2 separate components rather than templates within same FrahndsList component
        // filtered inside the App return rather than in the component
        function ActiveFriends(props){
            return (
                <section>
                    <h2>Active Friends</h2>
                    <ul>
                        {props.list
                            .map(frahnd => (
                                <li key={frahnd.name}> {/*React is zero amounts happy with this*/}
                                    <span>{frahnd.name}</span>
                                    <button onClick = { ()=> {props.onRemoveFriend(frahnd.name)} }>Bye {frahnd.name}!</button>
                                    <button onClick = { ()=> {props.onToggleFriend(frahnd.name)} }>Deactivate</button>
                            </li>
                        ))}
                    </ul>
                </section>
            )
        }
        function InactiveFriends(props){
            return (
                <section>
                    <h2>Active Friends</h2>
                    <ul>
                        {props.list
                            .map(frahnd => (
                            <li key={frahnd.name}> {/*React is zero amounts happy with this*/}
                                <span>{frahnd.name}</span>
                                <button onClick = { ()=> {props.onRemoveFriend(frahnd.name)} }>Bye {frahnd.name}!</button>
                                <button onClick = { ()=> {props.onToggleFriend(frahnd.name)} }>Activate</button>
                            </li>
                        ))}
                    </ul>
                </section>
            )
        }

        function App(){
            const { useState } = React; //destructure from React 
            const frahnds = [ //tmg also went the route of turning it into array of objs but mentioned you could have made a second array for inactives
                            // prob simplified as we can assume newly added friend is active
                            // notice: key property is no more in tmg solution
                {
                    name: 'Jake',
                    active: true,
                }, 
                {
                    name: 'Amy',
                    active: true,
                }, 
                {
                    name: 'Raymond',
                    active: true,
                }, 
                {
                    name: 'Charles',
                    active: true,
                },
                {
                    name: 'Rosa',
                    active: true,
                }, 
                {
                    name: 'Terry',
                    active: true,
                }
            ] //starting sitch only
            const [frahndqueue, setFrahndqueue] = useState(frahnds);
            const [newFrahnd, setNewFrahnd] = useState('')
            function handleChange(e){
                setNewFrahnd(e.target.value)
            }
            function handleAddFriend(name){
                if (frahndqueue.filter(frahnd => frahnd.name === name).length === 0){ //i.e., the friend isn't there already
                    const updatedFrahndQueue = frahndqueue.concat({name, active: true}) 
                    setFrahndqueue(updatedFrahndQueue) //now you make frahndqueue equal its updated self with the new frahnd
                    setNewFrahnd('') //clearing it after submission is best practice I think
                }
            }
            function toggleFriend(name){
                // tmg makes it a toggle - whatever it was before, make it the opposite.
                // I think this approach is a bit wasteful
                // maybe that's bc of how classes work?
                // modifying this.
                const frahndToEdit = frahndqueue.find(frahnd => frahnd.name === name)
                // then remove the friend you have to edit state of 
                const updatedFrahndQueue = frahndqueue.filter(frahnd => frahnd.name !== name) 
                    .concat({ //then add a modified vers of the friend you removed
                        name,
                        active: !frahndToEdit.active //toggle to opposite of what it was
                    })
                // instead of returning this, just update state
                setFrahndqueue(updatedFrahndQueue);
            }
            function clearAll(){
                setFrahndqueue([])
            }
            function handleRemoveFriend(name){
                const updatedFrahnds = frahndqueue.filter(friend => friend.name!==name)
                setFrahndqueue(updatedFrahnds)
            }
            return (
                <section id="container"> 
                    <h1>An odd tracker</h1>
                    <input 
                        type='text'
                        placeholder='Type new friend name'
                        value= {newFrahnd}
                        onChange={handleChange}  //need to capture the value of what's entered
                    />
                    <button
                        onClick = { ()=> { handleAddFriend(newFrahnd) }}
                    >
                        Submit
                    </button>
                    <button
                        onClick = {clearAll}
                    >Clear all
                    </button>
                    <ActiveFriends 
                        list= {frahndqueue.filter(frahnd => frahnd.active === true)} 
                    //  isActive= {false}
                        onAddFriend = { handleAddFriend }
                        onRemoveFriend = { handleRemoveFriend }
                        onToggleFriend = { toggleFriend }
                    />
                    <InactiveFriends
                        list= {frahndqueue.filter(frahnd => frahnd.active === false)}
                        onAddFriend = { handleAddFriend }
                        onRemoveFriend = { handleRemoveFriend }
                        onToggleFriend = { toggleFriend }
                    />
                        
                </section>
            )
        }
        const root = ReactDOM.createRoot(
            document.querySelector('#app')
        )
        root.render(<App />)
    </script>
</body>
</html>